<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiple Shooting Functionality · DiffEqFlux.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://diffeqflux.sciml.ai/stable/utilities/MultipleShooting/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DiffEqFlux.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DiffEqFlux.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DiffEqFlux.jl: High Level Scientific Machine Learning (SciML) Pre-Built Architectures</a></li><li><span class="tocitem">Differential Equation Machine Learning Tutorials</span><ul><li><a class="tocitem" href="../../examples/augmented_neural_ode/">Augmented Neural Ordinary Differential Equations</a></li><li><a class="tocitem" href="../../examples/collocation/">Smoothed Collocation for Fast Two-Stage Training</a></li><li><a class="tocitem" href="../../examples/hamiltonian_nn/">Hamiltonian Neural Network</a></li><li><a class="tocitem" href="../../examples/tensor_layer/">Physics-Informed Machine Learning (PIML) with TensorLayer</a></li><li><a class="tocitem" href="../../examples/multiple_shooting/">Multiple Shooting</a></li></ul></li><li><span class="tocitem">Layer APIs</span><ul><li><a class="tocitem" href="../../layers/BasisLayers/">Classical Basis Layers</a></li><li><a class="tocitem" href="../../layers/TensorLayer/">Tensor Product Layer</a></li><li><a class="tocitem" href="../../layers/CNFLayer/">Continuous Normalizing Flows Layer</a></li><li><a class="tocitem" href="../../layers/SplineLayer/">Spline Layer</a></li><li><a class="tocitem" href="../../layers/NeuralDELayers/">Neural Differential Equation Layers</a></li><li><a class="tocitem" href="../../layers/HamiltonianNN/">Hamiltonian Neural Network Layer</a></li></ul></li><li><span class="tocitem">Utility Function APIs</span><ul><li><a class="tocitem" href="../Collocation/">Smoothed Collocation</a></li><li class="is-active"><a class="tocitem" href>Multiple Shooting Functionality</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Utility Function APIs</a></li><li class="is-active"><a href>Multiple Shooting Functionality</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multiple Shooting Functionality</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DiffEqFlux.jl/blob/master/docs/src/utilities/MultipleShooting.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Multiple-Shooting-Functionality"><a class="docs-heading-anchor" href="#Multiple-Shooting-Functionality">Multiple Shooting Functionality</a><a id="Multiple-Shooting-Functionality-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-Shooting-Functionality" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="DiffEqFlux.multiple_shoot" href="#DiffEqFlux.multiple_shoot"><code>DiffEqFlux.multiple_shoot</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Returns a total loss after trying a &#39;Direct multiple shooting&#39; on ODE data and an array of predictions from each of the groups (smaller intervals). In Direct Multiple Shooting, the Neural Network divides the interval into smaller intervals and solves for them separately. The default continuity term is 100, implying any losses arising from the non-continuity of 2 different groups will be scaled by 100.</p><pre><code class="language-julia hljs">multiple_shoot(p, ode_data, tsteps, prob, loss_function, solver, group_size;
               continuity_term=100, kwargs...)
multiple_shoot(p, ode_data, tsteps, prob, loss_function, continuity_loss, solver, group_size;
               continuity_term=100, kwargs...)</code></pre><p>Arguments:</p><ul><li><code>p</code>: The parameters of the Neural Network to be trained.</li><li><code>ode_data</code>: Original Data to be modelled.</li><li><code>tsteps</code>: Timesteps on which ode_data was calculated.</li><li><code>prob</code>: ODE problem that the Neural Network attempts to solve.</li><li><code>loss_function</code>: Any arbitrary function to calculate loss.</li><li><code>continuity_loss</code>: Function that takes states <span>$\hat{u}_{end}$</span> of group <span>$k$</span> and</li></ul><p><span>$u_{0}$</span> of group <span>$k+1$</span> as input and calculates prediction continuity loss   between them.   If no custom <code>continuity_loss</code> is specified, <code>sum(abs, û_end - u_0)</code> is used.</p><ul><li><code>solver</code>: ODE Solver algorithm.</li><li><code>group_size</code>: The group size achieved after splitting the ode_data into equal sizes.</li><li><code>continuity_term</code>: Weight term to ensure continuity of predictions throughout different groups.</li><li><code>kwargs</code>: Additional arguments splatted to the ODE solver. Refer to the</li></ul><p><a href="https://diffeq.sciml.ai/dev/analysis/sensitivity/">Local Sensitivity Analysis</a> and   <a href="https://diffeq.sciml.ai/dev/basics/common_solver_opts/">Common Solver Arguments</a>   documentation for more details. Note: The parameter &#39;continuity_term&#39; should be a relatively big number to enforce a large penalty whenever the last point of any group doesn&#39;t coincide with the first point of next group.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/DiffEqFlux.jl/blob/006ca9592d3585b2dfb00831f5805c85965c94b5/src/multiple_shooting.jl#L1-L37">source</a></section><section><div><p>Returns a total loss after trying a &#39;Direct multiple shooting&#39; on ODE data and an array of predictions from each of the groups (smaller intervals). In Direct Multiple Shooting, the Neural Network divides the interval into smaller intervals and solves for them separately. The default continuity term is 100, implying any losses arising from the non-continuity of 2 different groups will be scaled by 100.</p><pre><code class="language-julia hljs">multiple_shoot(p, ode_data_ensemble, tsteps, ensemble_prob, ensemble_alg, loss_function, solver,
                group_size; continuity_term=100, trajectories)
multiple_shoot(p, ode_data_ensemble, tsteps, ensemble_prob, ensemble_alg, loss_function,
                continuity_loss, solver, group_size; continuity_term=100, trajectories)</code></pre><p>Arguments:</p><ul><li><code>p</code>: The parameters of the Neural Network to be trained.</li><li><code>ode_data_ensemble</code>: Original Data to be modelled. Batches (or equivalently &quot;trajectories&quot;) are located in the third dimension.</li><li><code>tsteps</code>: Timesteps on which <code>ode_data_ensemble</code> was calculated.</li><li><code>ensemble_prob</code>: Ensemble problem that the Neural Network attempts to solve.</li><li><code>ensemble_alg</code>: Ensemble algorithm, e.g. <code>EnsembleThreads()</code></li><li><code>loss_function</code>: Any arbitrary function to calculate loss.</li><li><code>continuity_loss</code>: Function that takes states <span>$\hat{u}_{end}$</span> of group <span>$k$</span> and</li></ul><p><span>$u_{0}$</span> of group <span>$k+1$</span> as input and calculates prediction continuity loss   between them.   If no custom <code>continuity_loss</code> is specified, <code>sum(abs, û_end - u_0)</code> is used.</p><ul><li><code>solver</code>: ODE Solver algorithm.</li><li><code>group_size</code>: The group size achieved after splitting the ode_data into equal sizes.</li><li><code>continuity_term</code>: Weight term to ensure continuity of predictions throughout</li></ul><p>different groups.</p><ul><li><code>trajectories</code>: number of trajectories for <code>ensemble_prob</code>.</li><li><code>kwargs</code>: Additional arguments splatted to the ODE solver. Refer to the</li></ul><p><a href="https://diffeq.sciml.ai/dev/analysis/sensitivity/">Local Sensitivity Analysis</a> and   <a href="https://diffeq.sciml.ai/dev/basics/common_solver_opts/">Common Solver Arguments</a>   documentation for more details. Note: The parameter &#39;continuity_term&#39; should be a relatively big number to enforce a large penalty whenever the last point of any group doesn&#39;t coincide with the first point of next group.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/DiffEqFlux.jl/blob/006ca9592d3585b2dfb00831f5805c85965c94b5/src/multiple_shooting.jl#L123-L161">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Collocation/">« Smoothed Collocation</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.18 on <span class="colophon-date" title="Saturday 4 June 2022 01:13">Saturday 4 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
